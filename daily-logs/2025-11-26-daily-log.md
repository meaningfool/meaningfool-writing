---
title: "Activity Log - 2025-11-26"
date: 2025-11-26
---

## Learning

- **Performed Architectural Review and Refactoring of Graph Validation Feature**:
  - Identified technical debt in the monolithic `validateGraph` function (162 lines, "God Function" mixing disparate rules)
  - Created detailed refactoring plan with 3 slices, ordered by risk: Components → Mapper → Validation Strategies
  - Key architectural patterns applied:
    - **Strategy Pattern for Validation**: Orchestrator (`graph-validation.ts`) coordinates validators but knows nothing about specific rules
    - **Smart Components, Dumb Containers**: Pushed edge path complexity down into `CustomEdge` so `LineageGraph` becomes declarative
    - **Hexagonal Architecture**: Domain layer (validators) is pure TypeScript with zero UI dependencies; `reactflow-mapper.ts` acts as Anti-Corruption Layer

- **Documented Architectural Insights**:
  - Created comprehensive architecture review with Mermaid dependency diagram
  - Analyzed the codebase through the lens of Hexagonal Architecture (Ports and Adapters)
  - Key insight: The separation allows business logic to be tested without a browser and makes the UI library swappable

- **E2E testing**:
  - **Robust Testing with `data-testid`**: Relying on text content is fragile; use `data-testid` and configure production builds to strip them via `reactRemoveProperties`
  - **Visual Verification Strategy**: "If it's visual, the test should take a picture" - use screenshot assertions for reproducible, version-controlled artifacts


